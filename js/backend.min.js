!function(e,n,a){"use strict";e.addDatePicker=function(n,t,r){var c="function"==typeof r.onSelect?r.onSelect:null;r.altField=t,r.dateFormat="yy-mm-dd",r.defaultDate=t.val(),r.firstDay=e.config.FIRST_DAY_OF_WEEK,r.onSelect=function(e){n.removeClass("rpbcalendar-popupVisible"),null!==c&&c(e)},n.datepicker("destroy"),n.addClass("rpbcalendar-datePickerPopup").datepicker(r);var d=a('<div class="rpbcalendar-popupBackground"></div>').appendTo(n);d.click(function(){n.removeClass("rpbcalendar-popupVisible")}),t.focusin(function(){n.addClass("rpbcalendar-popupVisible")})};var t=null;e.setupEventLinkField=function(n,a){a.click(function(a){a.preventDefault();var r=n.val();return r.match(/^https?:\/\//)?void(null===t||t.closed?t=window.open(r):t.location.replace(r)):void window.alert(e.i18n.BAD_LINK_MESSAGE)})},e.setupEventDateFields=function(a,t,r,c,d,i){a.prop("readonly",!0).change(function(){r.text("("+n(a.val()).format("dddd")+")")}).change(),c.prop("readonly",!0).change(function(){i.text("("+n(c.val()).format("dddd")+")")}).change(),e.addDatePicker(t,a,{onSelect:function(e){d.datepicker("option","minDate",e),a.change(),c.change()}}),e.addDatePicker(d,c,{minDate:a.val(),onSelect:function(){c.change()}})};var r=0;e.setupEventRow=function(n){var t=a("#rpbcalendar-eventEntry-"+n);r=Math.max(r,n)+1,e.setupEventDateFields(a(".rpbcalendar-eventDateBeginField",t),a(".rpbcalendar-eventDateBeginPicker",t),a(".rpbcalendar-eventDateBeginWeekday",t),a(".rpbcalendar-eventDateEndField",t),a(".rpbcalendar-eventDateEndPicker",t),a(".rpbcalendar-eventDateEndWeekday",t)),a(".rpbcalendar-cloneEntryButton",t).click(function(c){c.preventDefault();var d=t.clone(),i=r;d.find("textarea").each(function(e,n){a(n).val(a('textarea[name="'+a(n).attr("name")+'"]',t).val())}),d.find('*[id$="-'+n+'"]').andSelf().each(function(e,t){a(t).attr("id",a(t).attr("id").replace(new RegExp(n+"$"),i))}),d.find('*[for$="-'+n+'"]').each(function(e,t){a(t).attr("for",a(t).attr("for").replace(new RegExp(n+"$"),i))}),d.find('*[name$="_'+n+'"]').each(function(e,t){a(t).attr("name",a(t).attr("name").replace(new RegExp(n+"$"),i))}),d.find('*[name$="_'+n+'[]"]').each(function(e,t){a(t).attr("name",a(t).attr("name").replace(new RegExp(n+"\\[\\]$"),i+"[]"))}),t.after(d),e.setupEventRow(i)}),a(".rpbcalendar-removeEntryButton",t).click(function(e){e.preventDefault(),t.detach()})}}(RPBCalendar,moment,jQuery);